const fetch = require('node-fetch');

module.exports = async function(params) {
    if (!params.country && !params.sort) {
        let countries = await fetch(`https://corona.lmao.ninja/v2/countries`).then(r=>r.json());
        if (!countries || countries.length == 0) return { error: "API may be down, please try again later."}
        else return countries
    } else if (!params.country && params.sort) {
        let countries = await fetch(`https://corona.lmao.ninja/v2/countries?sort=${params.sort}`).then(r=>r.json());
        if (!countries || countries.length == 0) return { error: "API may be down, please try again later."}
        return countries;
    } else if (params.country) {
        try { return await fetch(`https://corona.lmao.ninja/v2/countries/${params.country}`).then(r=>r.json()); } catch (e) { return { error: "API may be down, please try again later."}; };
    }
}